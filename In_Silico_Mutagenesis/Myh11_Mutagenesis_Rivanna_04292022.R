setwd("~/Desktop/")
# setwd("~/Desktop/R Pdgfrb:Dual")
library(Biostrings)
library(data.table)
library(BSgenome.Mmusculus.UCSC.mm10)
library(biomaRt)
library(org.Mm.eg.db)
library(dplyr)
library(data.table)
library(biomaRt)


#read in PPR sequences for whole murine genome
wholeGenomePPR <- read.csv("WholeGenome_List_mm10_20kPPRseq_03162022.csv")

#select PPR for gene you want to "mutate" --> in this case, we will select Myh11
Myh11PPR <- subset(wholeGenomePPR, subset = mgi_symbol == "Myh11")
#identify which PPR contains these SRF sequences, as there are multiple Myh11 PPRs generated --> UCSC genome confirms TSS=chr16:14291365
Myh11_PPR <- subset(Myh11PPR, end == "14291365")
write.csv(Myh11_PPR, "Myh11_PPR_20kb.csv")

#identify specific TF binding sequences to mutate 
##first read in list of known TFs binding to Myh11 PPR
Myh11_TFs <- read.csv("Myh11_TF_list_wMouseGenesONLY_031720222.csv")
Myh11_TFs <- Myh11_TFs[,-10]

#select TF binding information for Sp1, Sp3, SRF, and CTF/NF1 
Sp1 <- subset(Myh11_TFs, subset = TF_name == "SP1") #search for GC-rich sites
Sp1 <- subset(Sp1, subset = X %in% c("1653", "17551"))

Sp3 <- subset(Myh11_TFs, subset = TF_name == "SP3") #search for GC-rich sites
Sp3 <- subset(Sp3, subset = X %in% c("1644", "45207", "39951"))

SRF <- subset(Myh11_TFs, subset = TF_name == "SRF")
length(unique(SRF$TF_sequence)) #there are 3 unique SRF binding sequences --> delete duplicates
SRF <- SRF[-c(1,5),]

head(SRF$TF_sequence) #the specific sequences to mutate --> rename the sequences so they are easier to identify
SRF$TF_name[1] <- "SRF3"
SRF$TF_name[2] <- "SRF2"
SRF$TF_name[3] <- "SRF1"

#need to identify GC-rich areas between CArG1 (Chr16:14292512-14292528) and CArG2 (chr16:14291161-14291177)
SP1_SP3_find <- subset(Myh11_TFs, subset = chromStart > 14291161)
SP1_SP3_find <- subset(SP1_SP3_find, subset = chromStart < 14292528)

Sp1 <- subset(SP1_SP3_find, subset = TF_name == "SP1") #search for GC-rich sites
length(unique(Sp1$TF_sequence)) 
#not found in Sp1


Sp3 <- subset(SP1_SP3_find, subset = TF_name == "SP3") #search for GC-rich sites
length(unique(Sp3$TF_sequence))
#GC-rich found in Sp3 site 
Sp3 <- subset(Sp3, subset = X %in% c("39951"))
Myh11_PPR <- Myh11_PPR[,-20]
Myh11_Mut_PPR <- Myh11_PPR

Myh11_Mut_PPR$PPR_sequence <-"GTTGTTGTATGGTTTTGTGGAAGGCTGTTTTTTTTTTTTTAATAAAAAGGTAATAAATTATTTAGTGAGGAGATGTTGAGAGAAGGCTCAGGAAGTAAAGAGGGTTGATACAAAACCTGATGACCTGAGTTCAATCCTCAGGACCCACACAATGAAAAGAACAAACCAACTCCCACAAATTGTCTCTGACTTCTACACATGCACCACTGCATGTGTGAGCCCACATACATCTATACACCTGTATGACTACATGTGTCAGTCCACACACATAAATCATGTGTGAGCCCCCGCACACATACACCCATGAAATAAATGTTAATTTTGTTTGTGTTTTTGTTTTTGTTTTTTGTTTTTTTCAAGACAGGGTTTCTCTATATAGCCCTGGCTATCCTGGAACTAACTCTGTAGACCAGGCTGGCCTCAAACTCAGAATCTGCCTGCCTCTGCCTCCCAAGTGCTAGGATTAAAGGGGTGCCACCACTGCCCGGCTTAATTTTTTATTTTAAAATAAAAAGGTAAATAAGGGCTGGAGAGATGGCTCAGGGGTTAAGACTGCTTTTCCAGAGGTCCTGAGTTCAATTCCCACCACGTGGTGGTTTGCAACCATCTGTAATATGATCTGATGCCCTCTTCTGGTGTGTCTGAAGACAGCTAAAGTGTTCTCATATACATAAAATAAATACATCTATTTTTAAAGGAAAATAAAATAAAATGTACTTTAAACACCTAGTTCAGAAGTGTAAAGTATATTTTATATTTTCTGTAATAGATGATGACCCACCCATTTTAAATGGTCTACCATCACTTGGAGGGCTAGTGTTTGTGTCATTCCTCCTGAACAGCAAGCTGCCTCTTTTTAAGTTGCAACTAAGTTTAAAAAAACATCACAAAAGGTTTAACATTAAAACAAAAAGACAGGAAGATTACTACCAGGAACCTCATCTAAAACAGGGTTCAAAAGCACAAACCAGATCAAGTGCAAAGGTTGAGTCTCTGGCCAAAAGAGAGCGAAGTCATCTGGCTTCTCCCTGAGGCTTTGTTGCCCTTGACAGTTGTGAAGCACAAGACTGCTTTGGTCAAAGCCAAGCAAGCTGAAATGTTGGTTTCCAGACTGGATGCCCAGGAATGTTTGGGATTGGGGAGTGATGAGGACGGGATCCAGGATTCCTTTTAAACACAGCTTCATGATAACGACAACAGATAGGGCTCCGCTGACAACAACAGCTGTCCAGACCTGAGTTCAAGTACTGGTAACTGAGATAAAAAGCTAGCCTGGCCACGTATGATTGTAACCTAGCATGGGAGAAGGGTTGAGACATGCAGATCCCAAGAGCTTGATGGCAGTGCAGTGAGAGACCCTGTTTTAGGACTGAAGCATGTGCATTCATGCACCCACATGCATGTACCACCACATGAACATCACACACGTGCATGTGCACATGCACACACACACACACACACACACACACACACACACGCATGCGTGCCACATCTTTCTCATCCATCACTAAGATGGATAGTCCTAGACAGGACATTCCAGTTCTTGGCAGATTTTACAACTAGAAAACCACTCTGCTCCTATGAACCTGCAGGGAAAGGAGGAGCTCCCAGAACAACATTGGAAAGAATTCAGAGTCCTATAAATTAATTCTACCAGAAGTAGTTGTAATAGTTGCTATTCATATGGAGTGATAGTCTTTCATTTAATCCCCTAAATTAACTAAGTAAATAAATAGATAACAAAGCCCTAAACCAACCAACTAACTAACTAACTAAAGCTCTTAACTAACTAAATAAATAACAAAGCCCTAGGCGATGTCTAGGGGACAGCCTAGAGGCTGCTCCAGGCCCTGGGTTCCCATCCCCAGCACCACAGAACATGGTGACAATGCAAACAACACTTTGCTAGAGAGTACAGTTTAGAGGCAGGGTACCTCGTATACTCTAGGCCCTGGATTCAATCCCCAGCATTGCAAAACCACCTAGGAGAGATGGCAACACTTGTTTACCAGTGAGGAAACCGAGGCACACCGAGGCAAAGCAGCTGGTCGATCCTTTCAGCTAGTCTTATGGCTTCTGAAGAAAGTCGCAAGGTTTTTTTTATTGTATGTTTTTGTTTTTGTTTTTGTTTTTTCTTCTTTTAGAATTTGGAGGAGGCAGGCAGAGAACCCAAGGGCAGAAAGAATTACAGGCATGCAGAGGACACATTCTGCTTCTTTCTGGCAGTTTGGAAGTTCAGGGTAACTCAGTTCATTGTCAGAAGAACTTGCCTCAGCCTCTGCTCAGAGCCTGAAATTTTCAAAAGCTGGGGACAGTGACAATACAGCAAGAAATATCAGTACAGGCATTGCATAAAACAGGGAGGATGGAAAAACAATAAAACTGAACACACGTGTAGTCCTATGATGAAGGAGATGGTGGGTTTAAGTACACCTGGGCTACAAAGAGAGATCCTGATTCAAAACAATCAGTTAGGCTGGGCTATGGCACAATGGCAGAGTATTTACTTAGCATGCATAAGACCCTAGTTCTAATTCCAGTACCAAAAAGATATGATGGCTAGAACCAGCAAGGCAATGGCAGTACAGACTGAAGTGACATTTGTTCTTCTAACTCTGGGTCCTGCTCTGTCTCCTGATTTAGAGTGGCTTTTCTCAGTACTATTGGCCTTGGCATGGGTCAGTTCTCTGGCCCTGTGAAGTATGAGTTCAGCCCACTCTATGCCACTATCCACCATTTCCCAGGTGTGACATCAAAAGAAGGACTAGACACTGACAGATAGCACTCCCAGAAGGAAAACTGCCCCCAGTTTGAAACGGAAACTTTTATTTTGAGATAAGATCTAATGTATTCCAGGCTGGCTTCACATTATTATGTAGCTGGGAATAACTTTAAAGTTCTCCCGAGTGCTGAGATTTTAAGTATACGCTACCATATCTAGTTTCTGGAGTGTTGGAGATCAAACTTGGGGCTTTGTGTATACTAGCCAGACACTCTATGATCTGAGCTTTATTCCCATCACTAAATTGATTATTTTTCATTGACCAATATTTGAGGTACTGGAGATCAAATTTAGGCCTTGTACACGCTCAGTAAATGTTCTACCATTGAGCTACATACACAAGGCCCAAACTGGTCTCAAAGTAGCAATCCTCATGGAGTGTAGGTGTTACCACCATGCCCATCCCCACCCTACACATTGCCTGGATTTTAAATACCATAGAGATCAGAAATAAGTTCTTGGAGCAGAAGCTGAAGTTCACCAAAAGGGACCCAATAATGTCAGTTCTAGTTCAAGGCCACATCTGGGTCTGGAAAGTCACTTGACATACCAGGAGAGGGAAGAGCATGCTACGCACACTAGTTCTTCAAACTCATGCTGCCCCAGGAGGCCTTTGGGACACGAATCTGTTCTTAATCACCATCACATAGCCTTCTCATTCTTGAGACGGGGTCTCCTATAGCCCAAGCTAACCTTGAACTCACTATGTCATCAAAGATGGACTGGAACTGTTTCTTACCATGCCTGGATTGTGTGGTGCTGAGGGTGGAATGCAGGGCTTTGTACGTGCTAGGCGAGTATCCTATCAACTGAGCTACATCTGCTCAGGGCCCCTCTACTCACTGGGCATCAGAGCAGGAGCGGTTCACATTTATGATCTTGATTGTCTTATGAGGGCTCTGTGAAGTGGACATCACTTATATTCCTATTTTTCTATTACTACAACTAAGGTCATAAAAGGTTTTTTTTTTTTAAAAAAGTTTGACCTTTTTGTTAGATTGTTAGATCTAACAGTCCTTTTTGCTCTCAGCAGTAAATCTCTTCTTCACTCCCTGTCCCAATGCCATACACCTCCCTACCATCCCCAGGTCCCCAAGACACCTCCTCAGGAAAAAGAGAGTAAGAACCTGCCCCATCACAATGGCCTGGTAACACTGCCACACACACACTGGGAATCCCAATGGCTTTTCAAGCTGCTTTAGAAGGAAGCTCTTTCCAATGGCTAAGGTGAAATGACTCTGTCTCTCCCACTAAAGGCATTTGGAGATTAAGGAAGAGGGTTATGGGCTGGCAAGTCAGCAATGTGCTTGACGTGCAGACACTTGAAGACCTGAGGTAGAGCTTCAAAAACTATGTTTAAAAGAAAGAGAAAGAAAGAGAGAAAGAAAGAAAGAAAGAAAGAAAGAAAGAAAGGAAGGAAGGAAGGAAGGAAGGAAGAGAGAGAGAAAGAAAAGGAGAGGAAAGGAGAAGAGAGGAGAGGAGAGGAGAGGAGAGGAGAGGAGAGGAGAGGAGAGGAGAGGAGAGGAGAGGAGAGGAGGTGCCCTTAGGGTGGAGGGGAAAGACAGATCCTAGGGGCTCAGGGGCAGCCAGCCTATCCTATTTGGCAAGTTCCAGGCTGGTGAGGGTTCCTGTCTCCAAAAGCAAGGTGGAGGGTACCTGAGAAACAACAGCCAGTCATTGTGGCTTCTACTTGAATGCACACATACACATGAATACCTTCCCCTCCTTGCCTGCCCCCGTCCCTTCTTTCCACTGTCTCCTCTCCCCACTCCACACAACTGAGGTCACCCCTTGTTTAGGGCCTTTGGGTCCTCGGAGCCCCACCATGTTTTACATCTTACAACGCAGGTAAGAGCAATGTTTAAAATAGGTGTTTGAGACACAAGCCTGGCTGGTCCAGGCAGATATCCAGTCTCTTTCAAAGACCACTAAGAGACAGATGCTGATTCCAATGTGCTAGCTATTCACCTCTCTGCTGGGAACTCATGTGATTACAGGAACTCATATTCTTACAAGCCAAGAATATGTATACAAGCTAAATATCCTTACCCCAAAAGGTCTGAAGTCACATAGCTTTCTGAGGGTTAATATTGTGCAAGTGGACAAGTTCATATCTGACTTCATACAGCAGGTCACAATGAAAATGTAGCATCAGAAACATTGAATGTGGGGGCTGGCGAGATGGCTCGGGGGTTAAGAGCACTGACTGCTCTTCCAAAGGTCCTGAGTTCAATTCCCAGCAACTACATGGTGGCTTACAACCATCTGTAATGAGATCTGACTCCCTCTTCTGGAGTGTCTGAAGATAGCTACAGTGTACTTACATATAATAAATAAATAAATAAATAAATAAATAAATAAATAAATAATAAATCTTTAAAAAATAAAAAAGAAAGAAACATTGAGTGTAATGACTGTACAGCCATCTGCATAAAGCAAAGGTGAAACATCAAGATTTGTGCTCACAGCTGGATGTGATGGCTCCCACCATTAATTTTAGCATGTGGGAGGCACAGGCAGGAGGATCTCTATGAGTTCAAGGGCAGCCTGGTCTACAGAGAGCTCCAGGATAGCCAGTACTACATAGAGAGACTTTGTCTAAAAACAAAAATAAAGAAAAAAAGATAAACAACAAAAGTATTAGTGTTCTTGTTTCCAGGATATCTCATTATGAATATGCAAATATCCCAAAATCAAAAAGAATTTAAAAGAAAAGAAAAGGAAAATCCAGATCACTTCTGGTCCTAGGCACTTCTGATAAGCAATAGTTAGCTCCTACATAGGTACTTCCTCAAGCACCACTTATACATGGAGTCATGTGCCAAGTAGATTGTATTAAGAGTATATATTTGGTAAGCTATCAAACTTCCATATAACAGAATACTAGGCACCAGATAAAAAGAAGCATACAATATGAAGAATGATATGAAGATATAGAAAAGATAGTGAAGATTTGTGATAAGGTGAAATATGTTTTGTAAAATGCCAGGATTTGAATAAATGAGAAATTTGGCTTAGAAAAAAATTTAGAATGATATTTAAGAATGTTTGTTAGCCGAGCAGTGGTGGCACATGCCTTTAATCCCAGCAGATTTCTGAGTTTGAGGCCAGCCTGGTCTACAGAGTGAGTTCCAGGACAGCCAGGGCTACACAGAGAAACCCTGTCTCGAAAAACCAAAAATAAAAAATAAAAAAATAAAATAAAACAAAAAAGAATAAAATAAAAAGAATGTTTGTTAGGAAAAAATGGAGGGAAAAAAAAAAGGGAGAAACATGCTTATTTGGAACCAGAGGGATGGCTAGAATGACTTATGGCTTAAGACACTTGTGAGGTTCTCTGTCATTGGTTGCATGTTTTACTAGGGGAGGGGCAGGAAGGGACAGTTATTCTTTGGCCCGTTTCAGGAGCACTTTGTACACCACAATCCACAGATGCTGAAGTCCCTTCCATGACAAGCTGTAGTGTTTGCATAGCATCTTGAGCAACCTCCCAGCTGCCTTGAAGGGTGGCAAACATAGTTCTCCTGCTGCATGACTCAGGGATAGGGACAAAAAAGAAGGTCTGTATGTGTTCAGCTCAGATGCTGTTAAAAATGAACTTCTAGATTACAGTAGACTAGATTCATCTGTAGGGACCCATAGCCCAGAGAGCAAGTGGACCTGAGTGAAACAGGTCAGGTCCCCACCCTGTTGGCCATTCTGATGAGAATGGTTCCCTGAAACTCAGATGCATCATGGTAACCTGACCTTCCCTTGCTAGAATACTGGGCAGTTTCCTTCTCCCTTCAGTTCTAGCTTGCCTTTCTCCAACTCTGTGTCCCCTGGTCCTTAAGGCCTGTAGATCAATGTGATTAAATGTCACCAATGACAAAAAGAGAACCAGGGAGCAAAGGGGCCACTGTAAGAGCCAGGCAGACTTCTACCATGCACAGGAAGGAGATCCAATAAGAGTCTAAAGGAATAGTGATCACAACTGTGCTAGTAGAACTGGTCAGAAAGTATGCTGGTAACATGAGAGGTTTCAAAAAAGGAGCTGGCTTTGAAAAAAGATTTACACAAAAGGAAAATTAGGGGTAAGTTTCTGCTTTAGGGGAAAGACCACACTTTGGATTTTCTGGCTTATTGATACCAGCTGTGTCACACAGAGCACACTCCTAAACATCTCTAGTCATATAAATTACCATCAGATGAACTTTGCTGGTGTCAGCCTTGTGTCAAACCCTTCAAATGGGTCATCTACTGAAAGCTCCCAAAAGGGCATCCCTTAGGCTCTGGAGTTACAAGAACCTTAGTTTGTGAGAGCCCCCATCTTTGATAGATAGAACAAAGATATATATGAATGATTTATTTATTTATTATATATAGGTACACTGTAGCTGTCTTTAGACACTCCAGAAGAAGGGGCATCAGATCTCATTACAGATGGTTGTGAGCCACCATGTGGTTGCTGGGATTTGAACTCAGGACCTTCAGAAGAGCAGTCAGTGCTCTTAACAGCTGAGCCATCTTTCCAGCCCCCTAGAACAAAGTTTTCAAAGCCCACATTTATGAAATGGAGGGAAGACTATTAGTACTGATTCCAAAGGGCTACTGTGCGACTCCAATTAATGAACCTTTCTCTTTTGCTGCAGCCGTGGGAATCCAACCCTAGCTAAGTGATCTTCGACTTCTGAGAAGACTAAGCAAGTGCTACAAAAAACGTTAAGACACTGGCTTGTTCTCAACAGTCCCATTTTGCAGATGGGAAAATGATCAGGGAGGCCAACAGCAACAACATATTTTTAAAGATCAGCTGATTTCCAGGTAGCCCAGGCTGGCTTTGGACTCACTCAGCAGCTGATTTCCAGGTAGCCCAGGCTGGCTTTGGACTCACTCAGCAGCTGATTTCCAGGTAGCCCAGGCTGGCTTTGGACTCACTCAGCAGCTGATATGACCTTGAACTCCTGCCGTCTTACCTCTCAGATGCTGGGGTTGAAGTTGCGCACCATTAGGCTGGGGTTTGATTTTTTTTCCCATTTTTTTTTCCTGAGATAGTGTTTCCTATTGTAGTCCAGGATGGCCTGAACTTGCTATGTATTCCAGGTTAGCCTCAAACTCTCATTAATTCTCTCACCTTAGCCTTCCTTCCAAATGCTAGTATTATAGACATGAGCCACTATACCTGGCAAAATAATGTGGTTAAGACCTTCTGAGTATTTGAAATAGGATATAGTTTTCTAAATTACTCAATGGTTCATCAGATGTAAATACCACCTGTTCTTATTAAATGTATGGAAGACAGGAGCTAATTTCCACCAGAAAAAAATATACAAATAGAACTTCCAAATAAGAAGAGAGAGGGAAAAAAGAGCCTCACTGTCTTCTAAGTGCCCCCCATCTCTACAGGGAAAGACGGTGAAGCACCCAGAACCCAAGCCAGCCAGGCTGCATAGCAAGGCTGGGTGATTGGCCAAGGGGGCTGGGGATGGCCTCGTAGAAAACACTAGCATGTCTGCCTCCAGCCCAGCCTCTCACAGAAAAGTAATGATAAATCCATAGTGACTACCTTGTACGGAAGAGAGGCTCTATTTCAGATATAACAATGAAAGTCCATAGTGCTTATGAAGCAAACCCACAGGTTTCTCCAGGGTGGCTCAGCACGGGCGTGTTTTGGGGTCACCCAGCCTCATGGACTCCTACCACATCTGTTTCTCTCTAGGGAACAGCCTTTGTCAGTTTAAATTGGTAGAAGGTTTCAATCTTCTTCAAAAAGTGGTGGAGTCCACCAGAAACAGGAGTCCAACAAATTTTGGTTTTCAGGAAAGACAAAGAGCTGTCACGACAAGATGATCAACTTCGTGATGAAGTGTATATAATGATTCAAATAACTTGATTCCACTGAAGTGCTGTTAAGTACCTGGCTTGTTAAGTGTGCCATCAACCACATCAAAAAAGAGAAGGTGTTCCTTGCCATGAGAGACTTTTGGACCTGTATGGTCAAGCTCTCTTTCTTTAAGTCAAGTCTAAAATAGCATCTTGAAGTAAACTGAGCAAGAGAAGAACCTTCACCAGAGGACACAGAACGGAGCAGAGCAGTGTGCTGAACACAGCCGGACGTCCCTTCTTTCCCAGCAAGCTCCATGGCTTCTCGCAGTTCTTAGAGGTAGAACCTAAACAGCCTAGTCCCGGCTTTCTAAAAGGTTTCTTTTGTTCTCTGACAGACATAACTTTGAAAGGTGCTTTCCAAACAATTCTGAACTGGAATCGCAGAACTTTCTCCTGCTAGTTCCTCTCTCTGTCCTAAGAGTAACCTTCCCACTGAGGAGCCCCAAACCCAGCGCCTGCTCACTCGGTGCACCTGGGGGTGGGGAGGCAAATGGAGCCTCCGCACCCACCTGGACATCTGAGGCCCTAACCAACCAGGAGAAGAACTCCCTTGTTAATTCACAGAGTCTGGGGTCTGGAAGGGAACAGAGTGAAAGAAACTAGCCATATCTTACAATAAGCAGCCTTGTCTACCAGTAACAATCCACAGCAAAATCACCTAAGTAGATGGAAAACACACACACACACACACACACACACACACACACACACACACACACACCACAGCCTGTGCTCAGAACTATCAACACTTTCACCCATGTTTCTGAGTTACTTTGTGCAATGGTCAGTGGATTATCCATCCCATGACCTAGTCAGACTAACCTTGGGTTCCGATCACCATCCCAAATACTGGGATTTGAACCCAGGACCCGCAGTGCTCTACCACAGCACATTTGTCCACTGTGCAGCCTATAAACACTGGTTGGTTTTTAAGTAGACCATTTTGTTTTTTAGACTCTAGTCTTAAAATACCTGGAATTGGGCCCAGCCACCAGAATCTTTAATTGCTTACTCCACTTTCCCAGGTGGTTCTGCTCATGGGCAACCTGGGGATGCTGGTTTGACGTGGTGGGTAGTGGGGGGGGGGAGGGGAGTAATCACAGGAGGTCTAGAATGATCCTGTACCCGGCTTCTTCCCATTGTATCCATAAGAGATAACAATCAGGACCCCTGGAGTCCCCACTCCCAGGAGGATGCTTTAGAAGGCTTAAACCCACCACCCAGGCTTGCCCCTAAGGGACCAACTCTACTTACAGATCTACTCCGGGGGTGGATTAGCAGGAGGACACCGGATGGAGAGCTCGGATCTGGCACTGATCCCAGGCTGGGATGGTCCAAATCTCTCTGTAAGCTTCGGACGCCTGGCTTTATAGAGTCAGCGCTATCTGAGAGTGGAAAGGGGAGGTGGCTGTCGGACGTCCGAGAGTGGGAGGATCCTCTTCCCTTCGCGGCGGATCCCTGCAGGTGAGGAACAGAGCCGCACTGACCCACAGCCTCAGGCTTCGCTCCCTGTAGCCACCCAGATCCTGGGTCCTTACAGAAAAGGAATCCGGTATACAGAGTCTGTAGGGAAACGTGAGAATTTCTCCCCCTAGGTCCATTCCAGCTGGATTTTAACCTCTTCCTGTTCATACATACTGGAGGCTTGATACCTCCCACTCTCCTTCATCCCCTCTTCATTCACCTGCCACCTCTTAGATCTGAGGGCGGTTGTGTTTAGCAAAGGGAGGGGAAAGGTGATTTTTTTTTTTTTTTTTTGAACTCTGCAAGGTGCAAAGCAGGTCACCGCATATCCTCCAGTGACTGCTGGGAATGTGTGGGAAAAGAAAGGGAAACTTGTTTTTCCTAACTTGTTCTTTGCAGTTCCATTCATGCTACAACCAAAATTAAATATAATCCCAGGGTGCCTGGAACCAATAACGTGGTTTCTCTGAACATCGTTGAAAAGCGGGGTGCTGCTGGAGAAAGAGTGCATTATGGCACTTGGAGGATGCGTGCTAAGACCCTAAGAGAATGCGGGGTACTTGCTGGTCCCCCGCAAGTTCACAGCTGTCCCCCCTCAGCAAGGGATACTTCTCAATCTCTTTCCCTTAGCCCTGTATGGATCTAGGTCCCTGTCTCCCTGTCTCTTTTGTCGGACCTGACACACTCTCCATTACACTCTAGCTTTGATTTCCCTGTGACGATTTTTGTTCTGTCTCTATCATTTCATCTGTTATGTCCCTAAAGTCAGTTTCTTTCTCTCTCTCTCTCTCTCTCTCCCTCCCCCTCCCCCCCCCCTTGCACACACACCACTCAGGCCATAAAAGGAAGTCGAGGCAGAGCATCCGACCGGGGACGCCTCGCTCCCCGCGCGCGGACCCTCGAGGTCCCGGGCTGGTCCTCCCTCCTGGGCCTGGGCGGGAGACAACCCAAAAAGGCCAGGCGCAATTCTCGAAACAGGAATTCCCAGCGTGGCATACCAGCGGGGCTCTGGCTCCCCCTGAATCCATATGGTCCCGCGCAGCCTCCCGCTGAGCCCGCGGGGCGGTATAGGGACCCCAGTGCTCAGACAGGAGCTCCAGACCCAGGTGCAGCTGGTTCTTCCAACCCAAGGATGATTCTGGCCAAACCTGCCCCAGCCCTATTTTGCAGGCCAGAAGACTGAGTCCTGTGAGGGTCCTTAGCAAGCTCAGTACTGTTTAATACCAATGTTCACTCTGGAGAGCTGAGTTACGGATCACTGTGTACAAAGCCAACAGGGGTGCTGTGTGGCCTTTCATATCCCAGCCCATCTGGACCCCTTCCATATCCGTCCAGGACCAAGCTCACCTGCTTCTCAGACTTGAAAACATCTGGATCTTGGTCCTCCCCATCCCCATTCCTAACCCCATCCCAGCCTCACTGGGCAGCAATACACAGAGCCAAGGACAGCAGCTTGGCTGCCTCGATGTAGAGGTGGGGGAGGAGCCCTCCACATGATGGACGAGGCTGCTTCCCCAAAGCCTCTTCGCAGCTGCACGTAAAAGGAATGGAAACCGTCTGGGCATTGAGCCCAGGAGGAATGGAAGAGGGAAGCCCAGGACCCACCTGCACCTATCCCAGTCTGGAACCAGCCCAGAGCTTGCCATCCCCGTGTTAGGAAGGAAGGGCACTCCCGCAGCAGGCCTCAGTGAAGTCAATTCCAAGGAGCACAGCTGAGTTTTAAAGAATGGTATCAATTTTGAAACAAAACTAATTTCAGTACAAGGAGAGACTGGGTCAGTAAGACTGGTCAAAAGCACTTGCTGCCCAAGACTGCCTTGAGTTCCATCCTTAGGAGCCACGTGACTGAATGGAACACATCATTCTCTGACTTTCACGTGTAAGCAGTAGGGCACCCTGCTCCCCAATCAATTAGTGTTAGCATTTTTTTTTAATGGAAACTGTGTTGTGCATGTGGTAGATGTGCACACCCGTCAATCGCAGATGTCAGTTCTCAGGACCCATCTACCACAGGGTCTCACTGTATACACAGTTCTAGCTCGTTGGCCTCAAACTCTGTGTAAACCAGGCTGGCAACAAACTTGCTTTACACATGCTGGGATCCAATGTGTGCACATCTGACATTGATTTTGTTGTTTTTACTTTGTTTTTGAGACAGTCTCTCACAGCTGGGCTGGGATGCTTGGTGGTTACAGTGTGTCTGTTGTCCAGTGCCGTCTGGGTGTCTTTATATAAGTGTTAGAGATGGAATTCAGACCTCATCACCTCAGTCAAGAAAGGGGAAACTTTACTGCTTTCTTTACATCTAATGCCCAGAATGATGGCATGAAGTAGGTTCGTCAGCATCTACTGCTGAGGATCCAGGTTTGAAAGAGTATATATCATCTGGCCAATAAGAGCAAGGTTAACAGAGGAGCTGAGATTCCAACCTGGGTCCATTCATGGCATGGCTGGTGGTTACACTGTGTCTGTGTATACATTCTCGAGTGTGGGCGTCAACATTGTGTCCATAAGTTGCCCCTCCATTTTATTTTATGAGCATCTCTCACTGCACATGGAGCTTGTTGATTCTGCTAGGCTGCTAGACTGCAGAGCCGGACAGCAAAGCCCAGGGACCCCCCTCTGTCTGTCTTCCCAGTGTTGGGATTCTTGCTGTAACTACTGAGCCATCTCCCCAGACCAACTTACTGTTCCCCCGAGTCTTGAGTGTTGCTCACAATAGGCAAGCGCTGTCCCACTGAGGCCCAAAAGTCTGATCTCAGCCCTGCTAAGCACTAGCCAAGAACCTCTGGGGTTATCCATGTCCTTATGTGACACTGCCTTAGGAAAGGCTTTCTGCCTTCCCCCACCTTGCTGGGTTGTTAATGACAGTGCCGGCCTTGTATAAACCACCCATCCCCTCCTGGCATGCTTGGGCAGTACCCAGGGACAGTATGTTCACTTCACAGTCACTTGGGAAGTTTCTGTCCACTGTGAGAAGTTCCGATATCTGAAGTCTTCAGAAGGAAGTTCTACCTAGAACAGGGTAGAGGCTTCTATTTTTCTTGTGGTTGAAGAGGTCATTTATTGTAAGAAGAGGAGAAAAGTCACTTAACAAAATGCTCCTTTGGGTGGTGTCAAATAAATTGTATGTTTTTCTGTGATGGGAAGTGGACGATGAAGGGGAAATTTCTCTTTGGGGTCTTTTTTTTTTTTTCTAGCAAATAGTTTTAAATAGCTATTGGCTTGTAAAAGCCTCAGTATGTGATGCCCTCTAGCTTTAGGAAAATCAAAGATTGTATCCAAGCATGGCTGACTCTTGCAGGTGCTAAAGATTTAATCATTTAAAACTATATCAGCTGGCCTGAGGAGATGGCTCAGTGGGTAAGAGTGCTGCTGCTCACTGTACAACACCCGTGTAAAAAGTGGGACATGGCCACACATACCTTTAACGGGTGTGCTGTGAGACAGAGACAGGAGGCTCACCGGGGCTTGCTGGCTACCAGCCTAGCTCCAACAGGTTCAGTGAGAGACTCCTGTCTCGAGGGAATAGAGCACAGTGACAGGCCACCTGACATTCTCCTCTGGCCTCAAATGCATGTGTGCGTACGCACACAGACACAGACACTCAGACACACACAGTTTCATCCCAGGTCCATGGAAGATCTGTCTCACAGATCAGTGGGAACTGTTCCAAGCCCAGGCACTGGTCACCACTGGGTCTCAAGGCAGGAGACTGCACCTGCTGTGCTGTTTCCTCTTCACTCATGTCCCATTCTGGTCTTCCTATAACTACAGATGATGTCTCTATTGGAAAGGCCTCCATAGGGAATGGTCAGAAGCTTTGCATTTTCATAAACCTACACATGTTCTGGGTGGTGGGTTGAATGAGAATGTCCCCAGAGGCTCATATGTTTCAATCTTTGGTCCCCACTTGGTAGAACTGGGACGGTATAGGAGCTGTAGCCTTGTTGGAGCTGTGGTCTTTTGGAGGAAGTGAGTCACTGGGGTGGACTTTCAGGTTTCTAGAGATCATGCCATTCCCAACTAGTACTCTCTGCCTCCTGCGTGTGGATCAGTATGTAAGCTCCTGGCTACAGCTCCATTACCATGCCTGCCTATCTGCCAGATGGCCATAGCTTCTAGTCCTCTGGAACTGTAAGCCCCCAATAAATCCTTTCTTATTTAAGTTAGTAATATCTTAGTAGTAATACTTTGCCATAGCAATAGAAAAGTAACTAAGACACTACTGGGAAATTTACCCTAAGAGATGGACTTATCTCATGAAGTTCTGTGCGTGGGCATTTATAGGAGCATGGTTTTGTTATTGTTTTTTTAAGACATGGTCTCACCAAGTAGCCCAGACCTTTAAAACTGACCATCACACCTCCAGCTCAGCAGCTTTGTTAACTGCAAGCACCTGAAGGCAGCTAGGCCGGTTTTTAGTAGGTATACAGATAGCTAATAAAAAGGCAGGATTCTGCACTTTCTAGAAAGCTAACAAACCACAAAGCTATGGGAGGTATGCCAATCCTAGAAGGTTGAAGTGGTTGAAGCCACATGGTGTCCTGGGAAAGGTGGGCAAAGGTGTCAGGTACTGCCACCATGAACTCTCATCACCATGCTTTGTCAGGTGACAAAGAAGGCTCTTCTGTGACAACTGCAGCTCTCAAACAGATTCAGACAGTGGGAGAAGACAGGGCCTGTGGGAGGAGAGTGAGGGCACTCAGTGCTCCCCACTTCTGTTAGTCGGGCAACTGAAAGTTCTCTCTCTCTCTCTCTCTCTCTCTCTCTCTCTCTCTTTTCTGAGACAACACAACACTACATAGCCCTGACAGGCCTGCAATTTGCTATGTAGACCAGGCTGGCCTCAAACTCCAAAATCTGCTTGTGTCTACTTTCAGAGTACTGAGACAAAAGTATATGCTGCCAAACTACAATTTTACTTTTTGAGACAGGGTCCCTCACTGAACCCAGGGTTCACTAAAATGACTGGACAGATTGGCCCACAATGTCCAAGGATCACCCTGCTGCCACCTTCCCAGCTCTGTGATAGAAGGAAGCTACAGCTGTGCCCTGTTTCTTAGGTGCCTGGGTATCTGGGGATTTCATCATGTTTGCATGGAAAGCACTTTCCCTGACTGAGCCGCCTCCAGGAGTTTGGTCTCACTTTTATTTGAAGTATTACATGCAGACCACGGTCCTCATATGGTGGTTGCCACAAACATAGAATGCTAAGTGTCTGAGAAGCAGTGTTCCAGATGCCTTTAAAGGCACATTCTTAACCATCAATCCTCCAGACACTTGGCTTTTTGCTAAAGGAACAATCAGGTTTACATAATCAGCCAGGCATGCAAATCATATACAAACATGTTCTTGCACATAATAATAAAGCTATCTGTTTATTCTACACAAGCATATACACTAGTCTTAAACTTATGATCTCCAGAAGTCAGCCCTAGGCTTGATAGACATTTTTTCCCCCAAGTTTTGAATAACCCAGTCTCCTACAGCCATCTGGTCCTATTCCCATCCTGTTTTGTGTGACTTCAAGTTTTCCCATAAACTTCCCTTGTTATTTCTAGAAGATAACTTGCCCTAACCTCAAGAAACAGACAGTGAGATACCAATACTGTTTGTGAGGATAGTAAAGGGTCTTCTAGACCTGTGTTTTCCTTTCTTGGGAGTTTTTTTCAGCGTAGCCAGGCATGGTGCATAATTACAGCTCTCTGGAAGACAGAGGCACAGAGATCTACGAGTTTTAGGCCATCTGGTCTATATAGTGACAAGTTGTCTTGAAACCAAATGTTCCAGCTTACAAACCTTTTTAAGAAGCCGTAGGAAGTAAATCAGCTGACAGTGTTTATAAATCCTGCACAAATAGACAGCTACAGTAGACTGTCTCAACTCTTTGTTGTTGTCTGTGAGATCCTCAGGGTTTCTGGTTAGCTATGTTGTATGCATAGGAACATGTGAGAGCAGATGCTCAGAGCTCAGAAGAGGCCATCAGAGCCTCTGAAGAAGCAAAAGTGAGAAACACTGAGCCATCTCTCCAGCCCCTTGATTCTTTCTTTGGACACAAGGTCTGGCTACACAGTCAGGGCTAGCTTAGAACTACCAATCTCCAATCTTCCTGTCTGGGCCTCCCAGGTACTTTACTGGATTACAGGCATATTTCACCATGACCTGGCACTTCTTCAGCTTTTAGGAATACAAAATGGTTCTTTCTTTGGATAATTAAAAAAACAAAAATGGTAACATGGTTTAAAAATAGATGGTTTTCCCCTCTTTAAAGTAGCTCTTCAAATATACCTGGTCCTCAGGTTGTGGCAGTCTGTAAGAATGGTGGATATCAAGTGCACATATGTACCAGGCCTGCCTTCAAAGACCCCACGTGCCCAGTGCTTCAGCCCCAGTCATCCCCCCTCTGGATGACAAGATAGTGACGTGACAATCTACACAGAGATGAGCTGAGCTGCATTAAATGATTATTCAGAGTAAAACAGGTTAGAATCAAGACTCAGGAATGCATAAGGCTGGGATGGTGAGGTGGTTCAGTGGGTAAGACTGACTGCTCTTCCGAAGGACCTGAGTTCAAATCCCAACAACTACATGGTGGCTCACAACCACCTGCAATGAGATCTGATGCCCTCTTCTGGTGCGTCTAAAGACAGCGACAGTGTACTTATTTATAATAATAAATCTTAAAAAAAAAAAAAAAAGGGCTGGTGAGATGGCTCAGTGGGTAAGGTGGGTAAGAGCACCAACTGCTCTTCCGAAGGTTTCGAGTTCAAATCCCAGCAACCACATGGTGGCTCACAACCACCTGTAATGAGATCTGACGCCCTCTTCTGGTGCATCTGAAGACAGTTACAGTGTACTTATTTAAAATAATAAATAAAATTTAAAAAATAAATAAATAAAAAAATAAAAAAGGAATGCATAAAGCTGCATTTCTGTGTAGCTTCCACTTTAATGATTTCACATCCATATCCAAAATTATAAACACCAATATTTTCCCTTCATCTGGCCCTACATAACTGCAATTCCTAAGATAGCATAGCATCCATAGCTGACACTTCTGAACATTAACCAAGCCCTCCGGGAGAAGCTGGTATTTATATCTGAACAGAGAACACAATGGAATTTATAACTCTAGTCAGTGCAGACTTAAAACGGAAACGGGGATGTGTGCAGCTTTAGGCATTGGTGGCCTGCATGAGTCACAGTGCTAGAAGCTGAGAGATGCACTCTGAACCCAGCAACCCTGTGATGAGCACACTGAGTCCAGGAACCTGCGCACCTGTTCTGAATGCTCAGAGTCCAGCCCAGACTTTTAGTTTTGCATTATTTATCTAACAAACTGTTTTACTTAAAGCAAAGTTAAAATAATTATTTCCCCCTTTACCTTTTCATTAAATTCCCTAGTAGAAGCTAAACTGTTCTTGGGGAAAGAGTATTGTTATCTAGTTTAAAGATCAACATTAGAGTTTTCATTGATGTTATAAAGACCATGACCGCTGGGCGTGGTGATGCACGCCTTTAATCCCAGCACTCGGGAGGCAGAGGCAGGTGGATTTCTGAGTCTACAGAGTGAGTTCCAGGACCGCCATGGCTACACAGAGAAACCCTGTCTTGAAAAAAGAAAGAAAGAAAGGAAGAAAGAAAGAAAGAAAGAAAGAAAGAAAGAAAGAAAGAAAGAGAGAGAGAGAGAGAGAGAGAGAGAGAGAAGGAAGGAAAGAAAGACAGACAGACCATGACCATAAGCAACTTGGGAAGAAGAAGGTTTATTTCAGCTTACAGTTCAACATCACAGTTTGTCACTGAGAGAAATCACGGCAGAAGTTAATGCAGAGGCCACAGAGGAGTGCTACTTAGTGGCTTGCTCCCCATGGCTTGCTCAGTCTTTCTTACTGAACCCAGGATCACCTGCCCAGGGGTGACACCACCCACTGTGGGCTGGACCCTCCCATATCAATCATGAATCAAGAAAAATGTACTACAGGTTTGCCCATAAGCCAATCTGATGGAGGGATTTTCTCAATTCAGAGTCCCTCTCCCCAAATGACTCTAGCTTGTATCAAGTTGATATAAAACTAGCCAGGGCAGGCAATAATAATTCAGGTATTTTTTAAAAAATCAAACTTCATATAAATTAAGTTCTGGTTTTAATATTCCTTTAGATATTTTTTCAAAACATGAATGACTTTCCCCATAGGTCCATATACTTCTAGCTGAAAAAAGTTTAATGAGCAGAGCACATGGACAAAGACCTGTTCTTGTGCTTTCTTTCTTCAGTGCTAGGACTGAACCCAGGACCTTGCATAGGGAGGGAAGTGCTTTACCAGCAGCATAGCAACAGCCCTTAGAGCTGGCCAAAAAACCCAAAACAAAACCCTATACAAAGTACTAAAAAGCCCTTTCAGATTTCACAAATGAGAACTTTAAAAATACATCCTGAAAACAATAAATTTTCCCCAGTGGCATCCAGCAAGCGAGACGACAGATCAGCTTTCCACAGATGCAGTAAACCATGAGTGGCTGAATGCAGACACTCAAACATTTACAAGCAGTGGTGGTCTAATTGATGGCATTGGGAATAATACGTCGGTTACTCCACACACAGCTGAGGTGATGAGCCTGGTGTATGCATCGCATCATCTGCTGACTGCTTGTGCAGCAGCAGGAAGCTCTTCAGTTGTGGTTCTTGGCCCTGTGTCCTTCCTCACGTGGTCATCTAGAGAAAACACACAGGTGTCAATATTCACTGCAAATCCCAACAGGCAGACAAGCAAGCACTTATGTTATAGGGCATTGTGTTAGTACTTTATGAGTTTTCCTTACAACATGTACTGTACTACCATGCATGCAGAAGTCAGAGGACAACTTGAGAGAATCAGTGCTTTCCTTCTACCATGTGTGTCCAGGTATTGAACTCGGGTCATGAGGCTTGGCAGCAAACCTGCTGAACTATCTTTGTGAACTCTACTCATGTCTTAAGCATCACTGAAGAAATCATAACTGTTTGGTATTAGAGACTAACTGTAATAATTCAAGTGTTTCTTCATTTGGAGGGTAGAGGAACAAGAGGGTCTCACTGTTTAGCCCAGGCTGGCCTTCTGCCTCAGCTTGAGTGCTGATGTCACAGGCTTCAAGCACAGGCTCAGCTTTTCTTTTTTCTTTTTTCCCCTTGGAGTGAAGTGCAGCGTGGAGCCCTGTAAGCCACTATCTCAGATATAAGGAATGGACTCAGGAGGAAGGACAAGTGTGCAATCAGCATTGTAGGGCCAACAAAACCACTATGATTGCCTGTTAGCTGAGCCCTCCTGTGGAACACAAAAAAGGGGGTTGTTTTGTATCTATTGTAACACTATCCAGGAAATGGTAGAAAGTACTTTTAAAGCCTGCAAGATGGCTCAGGGAGTAAAGATGCTGCCACAAAGTCTGACTCCAACTTTGATCTTTAAAACTTACATGGAAGGACAGAACTGACTCCTACACGTTGTCCCTTACCCCCACATATGCACTATGGTCCATGCATGCACAAATAGATATAAGTGTAATAAAAGTGATAACTAAATAAAATAAAATCCAAAGATAAGCTGGGCATGGGGAGATACACCTTTAAGACCATCCCTTGGGAGGCTGAGGTAGAATAATAAATGCCATCCTGATCCACACTGAGATCTGCCTGGCTCTGCTCCACCCATGCTGGGTTACAGGTACACATGCCACGCTGGAGGGATAGTCCAGTGGTTCACAGAACTTGCTGCTAGAGAACCCACGTTCAGTTCCCACTGGACACATGGCAGCTCATAATGGTCTATAAGTCTAGTTTCTGGAAATCTGATGCCATCTTCTGGCTTCCTAAGACACCAGGCATGCACGAGGTA"
#have to manually put this together --> see Word document on repo
write.csv(Myh11_Mut_PPR, "Myh11_Mut_PPR.csv")
Myh11_Mut_PPR <- read.csv("Myh11_Mut_PPR_6combos.csv")
Myh11_Mut_PPR <- Myh11_Mut_PPR[,-1]

Myh11_TFs_Mut_ALL <- Myh11_TFs[-c(1:75532),]

#other mutations can be made/saved
Myh11_TFs_Mut_CArG3 <- Myh11_TFs[-c(1:75532),]
Myh11_TFs_Mut_CArG2 <- Myh11_TFs[-c(1:75532),]
Myh11_TFs_Mut_GCrich <- Myh11_TFs[-c(1:75532),]
Myh11_TFs_Mut_CTFNF1 <- Myh11_TFs[-c(1:75532),]
Myh11_TFs_Mut_CArG1  <- Myh11_TFs[-c(1:75532),]


for (i in 1:nrow(Myh11_TFs)) {
  seq <- Myh11_TFs$TF_sequence[[i]]
  if (Myh11_Mut_PPR$PPR_sequence[[3]] %like% seq == TRUE) {
    Myh11_TFs_Mut_ALL <- rbind(Myh11_TFs[i,],Myh11_TFs_Mut_ALL)
  }
  print(paste0(i, "_", Myh11_TFs$TF_name[[i]], "_done"))
}

write.csv(Myh11_TFs_Mut_ALL,"Myh11_TFs_Mut_ALL.csv")

# Myh11_TFs_Mut_CArG2 <- read.csv("Myh11_TFs_Mut_CArG2.csv")
# write.csv(Myh11_TFs_Mut_GCrich,"Myh11_TFs_Mut_GCrich.csv")
# write.csv(Myh11_TFs_Mut_CTFNF1,"Myh11_TFs_Mut_CTFNF1.csv")
# write.csv(Myh11_TFs_Mut_CArG1,"Myh11_TFs_Mut_CArG1.csv")
# write.csv(Myh11_TFs_Mut_ALL,"Myh11_TFs_Mut_ALL.csv")


library(tidyverse)
library(dplyr)
library(stringr)
library(data.table)
library(biomaRt)
library(BSgenome.Mmusculus.UCSC.mm10)
library(Biostrings)

unique_Mut_ALL_TFseq <- read.csv("Myh11_TFs_Mut_ALL.csv")
Myh11_TF_list <- read.csv("Myh11_TF_list_wMouseGenesONLY_031820222_FINAL.csv")
Mut_All_genes <- subset(Myh11_TF_list, subset = TF_sequence %in% unique_Mut_ALL_TFseq$TF_sequence)


{
  listMarts()
  ensembl=useMart("ensembl")
  listDatasets(ensembl)
  ensembl=useDataset("mmusculus_gene_ensembl", mart=ensembl)
  listAttributes(mart=ensembl)
  
  annoMouse <- getBM(attributes = c("ensembl_gene_id_version", "ensembl_gene_id", "entrezgene_id", 
                                    "mgi_symbol", "description", "external_gene_name"), mart=ensembl)
}


mouse = useMart("ensembl", dataset = "mmusculus_gene_ensembl")
homologues <- getBM(attributes = c("external_gene_name", "hsapiens_homolog_associated_gene_name"), filters = "external_gene_name", values = annoMouse$mgi_symbol, mart = mouse)

percentTable <- homologues
length(unique(percentTable$mgi_symbol))
colnames(percentTable)[1] <- "mgi_symbol" #note that these are NOT exlusively protein-coding genes
percentTable["Frequency"] <- NA
percentTable["Frequency"] <- 0
percentTable["Associated_Myh11_TFs"] <- NA

resultsTable <- Mut_All_genes

dataSet <- resultsTable
geneList <- (unlist(strsplit(dataSet$Mouse_Genes_with_TF_sequence, " "))) #add TF_name
geneList <- gsub(",", "", gsub("([a-zA-Z]),", "\\1 ", geneList))
geneList <- as.data.table(geneList)
colnames(geneList)[1] <- "gene"
geneList$gene <- str_trim(geneList$gene, "right")

frequencyTable <- table(geneList$gene)
frequencyTable <- as.data.table(frequencyTable) #this is my frequency table!
colnames(frequencyTable)[1] <- "mgi_symbol"
colnames(frequencyTable)[2] <- "Frequency"

library(dplyr)
finalTable <- percentTable %>% inner_join(frequencyTable,by="mgi_symbol")
finalTable <- finalTable[,-3]
colnames(finalTable)[4] <- "Frequency"
finalTable['% of Myh11 TFs that bind Mouse gene’s PPR'] <- NA


for (i in 1:nrow(finalTable)) {
  finalTable$`% of Myh11 TFs that bind Mouse gene’s PPR`[[i]] <- finalTable$Frequency[[i]]/(length(Mut_All_genes$X))*100
}

write.csv(finalTable, "Mut_All_geneFreq_05042022.csv")
finalTable <- read.csv("Mut_All_geneFreq_05042022.csv")
